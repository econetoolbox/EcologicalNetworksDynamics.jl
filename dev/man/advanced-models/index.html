<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Build Advanced Models · EcologicalNetworksDynamics.jl</title><meta name="title" content="Build Advanced Models · EcologicalNetworksDynamics.jl"/><meta property="og:title" content="Build Advanced Models · EcologicalNetworksDynamics.jl"/><meta property="twitter:title" content="Build Advanced Models · EcologicalNetworksDynamics.jl"/><meta name="description" content="Documentation for EcologicalNetworksDynamics.jl."/><meta property="og:description" content="Documentation for EcologicalNetworksDynamics.jl."/><meta property="twitter:description" content="Documentation for EcologicalNetworksDynamics.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="EcologicalNetworksDynamics.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="EcologicalNetworksDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">EcologicalNetworksDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Welcome</a></li><li><span class="tocitem">Guide</span><ul><li><a class="tocitem" href="../quickstart/">Quick Start</a></li><li><a class="tocitem" href="../foodwebs/">Generate Food Webs</a></li><li><a class="tocitem" href="../simple-models/">Build Simple Models</a></li><li class="is-active"><a class="tocitem" href>Build Advanced Models</a><ul class="internal"><li><a class="tocitem" href="#Functional-Responses"><span>Functional Responses</span></a></li><li><a class="tocitem" href="#Non-Trophic-Interactions"><span>Non-Trophic Interactions</span></a></li><li><a class="tocitem" href="#Temperature-Scaling"><span>Temperature Scaling</span></a></li><li><a class="tocitem" href="#Explicit-Nutrient-Dynamics"><span>Explicit Nutrient Dynamics</span></a></li><li><a class="tocitem" href="#Competition-Between-Producers"><span>Competition Between Producers</span></a></li></ul></li><li><a class="tocitem" href="../simulate/">Simulate the Community Dynamics</a></li><li><a class="tocitem" href="../output-analysis/">Analyse the Simulated Dynamics</a></li><li><a class="tocitem" href="../components/">Bonus: The Model and its Components (advanced)</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../lib/public/">Public</a></li><li><a class="tocitem" href="../../lib/internals/">Internals</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Guide</a></li><li class="is-active"><a href>Build Advanced Models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Build Advanced Models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/econetoolbox/EcologicalNetworksDynamics.jl/blob/main/docs/src/man/advanced-models.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Build-Advanced-Models"><a class="docs-heading-anchor" href="#Build-Advanced-Models">Build Advanced Models</a><a id="Build-Advanced-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Build-Advanced-Models" title="Permalink"></a></h1><p>In the previous section, we showed how to create relatively simple models. Here, we explain how to build more sophisticated models by modifying or adding the following features:</p><ul><li><a href="#Functional-Responses">Functional Responses</a></li><li><a href="#Non-Trophic-Interactions">Non-Trophic Interactions</a></li><li><a href="#Temperature-Scaling">Temperature Scaling</a></li><li><a href="#Explicit-Nutrient-Dynamics">Explicit Nutrient Dynamics</a></li><li><a href="#Competition-Between-Producers">Competition Between Producers</a></li></ul><h2 id="Functional-Responses"><a class="docs-heading-anchor" href="#Functional-Responses">Functional Responses</a><a id="Functional-Responses-1"></a><a class="docs-heading-anchor-permalink" href="#Functional-Responses" title="Permalink"></a></h2><p>By default, the functional response is classic as in <a href="https://doi.org/10.1086/285380">Yodzis and Innes, 1992</a>, that is parameterized by the attack rate and the handling time. We write below the corresponding dynamical system:</p><p class="math-container">\[\frac{dB_i}{dt} = g(B_i)
    + B_i \sum_{j \in \{ \text{res.} \}} e_{ij} F_{ij}
    - \sum_{j \in \{ \text{cons.} \}} B_j F_{ji}
    - x_i B_i\]</p><p class="math-container">\[F_{ij} = \frac{1}{m_i} \cdot
    \frac{\omega_{ij} a_{ij} B_j^h}{1 + c_i B_i
    + h_t \sum_{k \in \{ \text{res.} \}} \omega_{ik} a_{ik} B_k^h}\]</p><p>with:</p><ul><li><span>$\omega_{ij}$</span> preference of consumer <span>$i$</span> on resource <span>$j$</span></li><li><span>$c_i$</span> the intensity of intraspecific predator interference in consumer <span>$i$</span></li><li><span>$h$</span> the hill-exponent</li><li><span>$a_{ij}$</span> the attack rate of consumer <span>$i$</span> on resource <span>$j$</span></li><li><span>$h_t$</span> the handling time</li><li><span>$m_i$</span> the body mass of consumer <span>$i$</span></li></ul><p>The parameters of the functional response can be customized. For example, the default hill exponent is 2 (type III functional response).</p><pre><code class="language-julia hljs">using EcologicalNetworksDynamics
fw = Foodweb([2 =&gt; 1])
m = default_model(fw)
m.hill_exponent</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2.0</code></pre><p>But we can change its value, for instance to 1:</p><pre><code class="language-julia hljs">m.hill_exponent = 1 # Same as set_hill_exponent!(m, 1).
m.hill_exponent # Check that the value has changed.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>Above, we changed the value after the model was created. But this value can also be set when the model is created:</p><pre><code class="language-julia hljs">m = default_model(fw, ClassicResponse(; h = 1))
m.hill_exponent</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>Moreover, the dynamical system is often parameterized differently, with the bioenergetic functional response as in <a href="https://doi.org/10.1007/978-1-4020-5337-5_2">Williams, Brose and Martinez</a>, that is parameterized with half-saturation density. In this case, the dynamical system reads:</p><p class="math-container">\[\frac{dB_i}{dt} = g(B_i)
    + B_i \sum_{j \in \{ \text{res.} \}} e_{ij} F_{ij}
    - \sum_{j \in \{ \text{cons.} \}} B_j F_{ji}
    - x_i B_i\]</p><p class="math-container">\[F_{ij} = \frac{\omega_{ij} B_j^h}{B_0^h + c_i B_i B_0^h
    + \sum_{k \in \{ \text{res.} \}} \omega_{ik} B_k^h}\]</p><p>with:</p><ul><li><span>$\omega_{ij}$</span> preference of consumer <code>i</code> on resource <code>j</code></li><li><span>$B_0$</span> the half-saturation density</li><li><span>$c_i$</span> the intensity of intraspecific predator interference</li><li><span>$h$</span> the hill-exponent</li></ul><p>To change for the bioenergetic functional response, you can do:</p><pre><code class="language-julia hljs">m = default_model(fw, BioenergeticResponse())
m.half_saturation_density[2] # Consumer half-saturation density.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.5</code></pre><p>You can also tune the bioenergetic functional response. For instance, you can change the half-saturation density:</p><pre><code class="language-julia hljs">m = default_model(fw, BioenergeticResponse(; half_saturation_density = 0.1))
m.half_saturation_density[2] # Check that the value is the one we set.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.1</code></pre><h2 id="Non-Trophic-Interactions"><a class="docs-heading-anchor" href="#Non-Trophic-Interactions">Non-Trophic Interactions</a><a id="Non-Trophic-Interactions-1"></a><a class="docs-heading-anchor-permalink" href="#Non-Trophic-Interactions" title="Permalink"></a></h2><p>Food webs, and therefore trophic interactions, are at the core of the package. However, the importance of other interactions (hereafter non-trophic interactions) is increasingly recognized. For this reason, we offer the possibility to include non-trophic interactions in food web models. Four non-trophic interactions can be considered as in <a href="https://doi.org/10.1371/journal.pcbi.1007269">Miele et al., (2019)</a>:</p><ul><li>Competition for space between producers</li><li>Plant facilitation (e.g. because of nitrogen fixation or seed dispersal)</li><li>Interference between predators sharing a prey</li><li>Refuge provisioning for prey</li></ul><p>For example, let&#39;s compare the dynamics of a plant growing toward its carrying capacity with and without facilitation. In this simplistic setting, we do not consider trophic interactions, but only the focal plant (1)</p><pre><code class="language-julia hljs">using Plots

fw = Foodweb(zeros(Int, 2, 2))
m_no_facilitation = default_model(fw)
B0, t = [0.1], 10
sol_no_facilitation = simulate(m_no_facilitation, B0, t)
A = [0 0; 1 0]
m_facilitation = default_model(fw, FacilitationLayer(; A))
sol_no_facilitation = simulate(m_no_facilitation, B0, t)
sol_facilitation = simulate(m_facilitation, [0.1], t)
plot(
    sol_no_facilitation;
    xlabel = &quot;Time&quot;,
    ylabel = &quot;Biomass&quot;,
    idxs = [1],
    label = &quot;without facilitation&quot;,
)
plot!(sol_facilitation; idxs = [1], label = &quot;with facilitation&quot;)
savefig(&quot;facilitation.svg&quot;);</code></pre><p><img src="../facilitation.svg" alt="Figure illustrating facilitation effect"/></p><p>We observe that the plant grows faster with facilitation, as we intuitively expect.</p><h2 id="Temperature-Scaling"><a class="docs-heading-anchor" href="#Temperature-Scaling">Temperature Scaling</a><a id="Temperature-Scaling-1"></a><a class="docs-heading-anchor-permalink" href="#Temperature-Scaling" title="Permalink"></a></h2><p>The metabolic theory of ecology (MTE) describes how species biological rates scale with temperature. We allow scaling the metabolic rates of species with temperature, following the MTE, as in <a href="https://doi.org/10.1111/gcb.13086">Binzer et al. (2016)</a>. To do so, we simply have to pass the temperature to the model.</p><pre><code class="language-julia hljs">m = default_model(fw, Temperature(290)) # Note that the temperature is in Kelvin.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Model <span class="sgr90">(alias for EcologicalNetworksDynamics.Framework.System{&lt;inner parms&gt;})</span> with 18 components:
  - Species: 2 (:s1, :s2)
  - Foodweb: 0 link
  - Temperature: 290.0K
  - Body masses: [1.0, 1.0]
  - Metabolic classes: [:producer, :producer]
  - GrowthRate: [1.0799310794944612e-7, 1.0799310794944612e-7]
  - Carrying capacity: [4.071090742409496, 4.071090742409496]
  - ProducersCompetition: 1.0
  - LogisticGrowth
  - Efficiency: ·
  - Hill exponent: 2.0
  - Consumers preferences: ·
  - Intra-specific interference: [·, ·]
  - Handling time: ·
  - Attack rates: ·
  - ClassicResponse
  - Metabolism: [0.0, 0.0]
  - Mortality: [0.0, 0.0]</code></pre><p>For example, we can plot the attack rate as a function of temperature:</p><pre><code class="language-julia hljs">fw = Foodweb([2 =&gt; 1])
attack_rate = []
T_values = 273.15:1:310.15
for T in T_values
    local m = default_model(fw, Temperature(T))
    push!(attack_rate, m.attack_rate[2])
end
plot(T_values, attack_rate; xlabel = &quot;Temperature (K)&quot;, ylabel = &quot;Attack Rate&quot;)
savefig(&quot;temperature-attack-rate.svg&quot;);</code></pre><p><img src="../temperature-attack-rate.svg" alt="Figure of attack rate vs temperature"/></p><h2 id="Explicit-Nutrient-Dynamics"><a class="docs-heading-anchor" href="#Explicit-Nutrient-Dynamics">Explicit Nutrient Dynamics</a><a id="Explicit-Nutrient-Dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Explicit-Nutrient-Dynamics" title="Permalink"></a></h2><p>Producer growth dynamics is by default modelled by a logistic growth. But, we can also model explicit nutrient dynamics given by:</p><p class="math-container">\[\frac{\mathrm{d} N_l}{\mathrm{d} t} = D_l(S_l - N_l)-\sum^n_{i=1}{c_{li}G_i(N)B_i}\]</p><p>Where:</p><ul><li><span>$N_l$</span> is the concentration of nutrient <code>l</code></li><li><span>$D_l$</span> is the turnover rate of nutrient <code>l</code></li><li><span>$S_l$</span> is the supply rate of nutrient <code>l</code></li><li><span>$c_{li}$</span> is the nutrient concentration of producer <code>i</code> in nutrient <code>l</code></li><li><span>$r_i$</span> is the intrinsic growth rate of producer <code>i</code></li></ul><p>Moreover, the producer growth <code>G_i</code> is given by:</p><p class="math-container">\[G_{i}(N) = \min(\frac{N_1}{K_{1i}+N_1}, \dots, \frac{N_l}{K_{li}+N_l}) B_i\]</p><p>Where <code>K_{li}</code> is the half-saturation constant of producer <code>i</code> for nutrient <code>l</code>. For more details, see for instance <a href="https://doi.org/10.1098/rspb.2008.0718">Brose (2008)</a>.</p><p>To implement nutrient dynamics, we have to pass the corresponding component to the model.</p><pre><code class="language-julia hljs">m = default_model(fw, NutrientIntake(1))
m.n_nutrients # Number of nutrients.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1</code></pre><p>We can of course change the number of nutrients:</p><pre><code class="language-julia hljs">m = default_model(fw, NutrientIntake(3))
m.n_nutrients # Number of nutrients.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3</code></pre><p>We can also change the parameters of the nutrient dynamics, as the supply rate, the concentration, and the nutrient turnover rate:</p><pre><code class="language-julia hljs">m = default_model(fw, NutrientIntake(3; supply = 10.2))
m.nutrients_supply # Supply rate of nutrients.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element EcologicalNetworksDynamics.Nutrients.SupplyRates:
 10.2
 10.2
 10.2</code></pre><pre><code class="language-julia hljs">m = default_model(fw, NutrientIntake(3; turnover = 0.2))
m.nutrients_turnover # Turnover rate of nutrients.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element EcologicalNetworksDynamics.Nutrients.TurnoverRates:
 0.2
 0.2
 0.2</code></pre><pre><code class="language-julia hljs">m = default_model(fw, NutrientIntake(3; concentration = 0.9))
m.nutrients_concentration # Concentration of nutrients.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×3 EcologicalNetworksDynamics.Nutrients.Concentrations:
 0.9  0.9  0.9</code></pre><p>Nutrient concentration is a matrix, where rows correspond to producers and columns to nutrients.</p><h2 id="Competition-Between-Producers"><a class="docs-heading-anchor" href="#Competition-Between-Producers">Competition Between Producers</a><a id="Competition-Between-Producers-1"></a><a class="docs-heading-anchor-permalink" href="#Competition-Between-Producers" title="Permalink"></a></h2><p>By default, producers follow logistic growth.</p><p class="math-container">\[G_i = 1 - \frac{B_i}{K_i}\]</p><p>Where <span>$K\_i$</span> is the carrying capacity of the producer <code>i</code>, and <code>B_i</code> is its biomass. But this formulation can be generalized to the case of competition between producers, thereby reading:</p><p class="math-container">\[G_i = 1 - \frac{\sum_{j=1}^{S} a_{ij} B_j}{K_i}\]</p><p>Where <code>a_{ij}</code> is the competition coefficient between producer <code>i</code> and <code>j</code>. Producer competition can be implemented by modifying the producer growth component of the model.</p><pre><code class="language-julia hljs">foodweb = Foodweb(zeros(Int, 2, 2)) # 2 producers.
g_no_competition = LogisticGrowth(; producers_competition = [1 0; 0 1]) # Default.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">blueprint for LogisticGrowth:
  r: blueprint for GrowthRate:
    allometry: (
      producer (:p, :prod) =&gt; (
        prefactor (:a) =&gt; 1.0
        source_exponent (:b) =&gt; -0.25
      )
      invertebrate (:i, :inv) =&gt; ()
      ectotherm (:e, :ect) =&gt; ()
    )
  K: blueprint for CarryingCapacity:
    K: 1.0
  producers_competition: blueprint for ProducersCompetition:
    alpha: 2×2 SparseArrays.SparseMatrixCSC{Float64, Int64} with 2 stored entries:
 1.0   ⋅ 
  ⋅   1.0</code></pre><pre><code class="language-julia hljs">g_competition = LogisticGrowth(; producers_competition = [1 0.1; 0.9 1])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">blueprint for LogisticGrowth:
  r: blueprint for GrowthRate:
    allometry: (
      producer (:p, :prod) =&gt; (
        prefactor (:a) =&gt; 1.0
        source_exponent (:b) =&gt; -0.25
      )
      invertebrate (:i, :inv) =&gt; ()
      ectotherm (:e, :ect) =&gt; ()
    )
  K: blueprint for CarryingCapacity:
    K: 1.0
  producers_competition: blueprint for ProducersCompetition:
    alpha: 2×2 SparseArrays.SparseMatrixCSC{Float64, Int64} with 4 stored entries:
 1.0  0.1
 0.9  1.0</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../simple-models/">« Build Simple Models</a><a class="docs-footer-nextpage" href="../simulate/">Simulate the Community Dynamics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Friday 28 March 2025 17:20">Friday 28 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
